# GlassesValidator
Tool for automatic determination of data quality (accuracy and precision) of wearable eye tracker recordings.

Please cite:
Niehorster, D.C., Hessels, R.S., Benjamins, J.S., Nyström, M. and Hooge, I.T.C. (submitted).
GlassesValidator: A data quality tool for eye tracking glasses.

# How to acquire
The glassesValidator is available from ``https://github.com/dcnieho/glassesValidator``, and supports Windows, MacOS and Linux.
For Windows and MacOS users who wish to use the glassesValidator GUI, the easiest way to acquire glassesValidator is to [download
a standalone executable](https://github.com/dcnieho/glassesValidator/releases/latest).

For users who wish to use glassesValidator in their Python code, the package can be installed directly from Python using the command
``python -m pip install glassesValidator``. Should that fail, this repository is pip-installable as well:
``python -m pip install git+https://github.com/dcnieho/glassesValidator.git#egg=glassesValidator``.

# Workflow
The glassesValidator method consists of two parts, 1) a poster and validation procedure that are used during a recording, and
2) Python software for later offline processing of the recording to estimate data quality measures.

## glassesValidator projects
The glassesValidator GUI organizes recordings into a project folder. Each recording to be processed is imported into this project folder
and all further processing is done inside it. This folder can furthermore a folder specifying the configuration of the project.
Such a configuration should be made if you used a poster different from the default (if no configuration folder is present, the default
settings are automatically used), and can be depoyed with the ``Deploy config`` button in the GUI, or the
``glassesValidator.config.deployValidationConfig()`` call from Python.


## The poster
The default poster is available [here](/src/glassesValidator/config/markerBoard/board.pdf), from the GUI with the ``Get poster pdf``
button, and can also be acquired from a Python script with ``glassesValidator.config.markerBoard.deployPdf()``.
The poster should be printed at A2 size, as defined
in the pdf file, and is designed to cover a reasonable field of view when participants view it at armslength (20 x 17.5 deg
at 60 cm). In order to check that the poster was printed at the correct scale, one should measure the sides of the ArUco markers.
We strongly recommend performing this check because printers may not be calibrated. In the case of the default glassesValidator
poster, each ArUco marker should have sides that are 4.19 cm long. If the poster was printed at the wrong scale, one must adapt
the glassesValidator configuration to match the size and position of the ArUco markers and fixation targets on your poster.

### Customizing the poster
The poster pdf file is generated by the [LaTeX file in the same folder as the pdf](/src/glassesValidator/config/markerBoard/board.tex). Its looks are defined in the files in the [config folder](/src/glassesValidator/config). Specifically, the files [`markerPositions.csv`](/src/glassesValidator/config/markerPositions.csv) and the files [`targetPositions.csv`](/src/glassesValidator/config/targetPositions.csv) define where the ArUco markers and gaze targets are placed on the poster. Each coordinate in these files is for the center of the marker or gaze target and the origin (0,0) is in the bottom left of the poster. The [configuration file](/src/glassesValidator/config/validationSetup.txt) contains the following settings for the poster:

|setting|description|
| --- | --- |
|`distance`|viewing distance in cm, used to convert coordinates and sizes in degrees to cm. Only used when `mode` is `cm`.|
|`mode`|`cm` or `deg`. Sets the unit for the `markerSide` and `targetDiameter` below as well as for interpreting the coordinates in the marker and target position files.|
|`markerSide`|Size of ArUco markers. In cm or deg, see `mode` setting.|
|`markerPosFile`|File in the config folder where the markers to draw are specified, e.g. `markerPositions.csv`.|
|`targetPosFile`|File in the config folder where the targets to draw are specified, e.g. `targetPositions.csv`.|
|`targetType`|Type of targer to draw, can be `Tobii` (the calibration marker used by Tobii) or `Thaler` (layout ABC in the lower panel of Fig. 1 in [Thaler et al., 2013](https://doi.org/10.1016/j.visres.2012.10.012)).|
|`targetDiameter`|Diameter of the gaze target. In cm or deg, see `mode` setting. Ignored if `targetType` is `Tobii` and `useExactTobiiSize` is `1`.|
|`useExactTobiiSize`|`0` or `1`. If `1`, the gaze targets have the exact dimensions of a Tobii calibration marker (though possibly different colors). I.e., the `targetDiameter` parameter is ignored. Only used if `targetType` is `Tobii`.|
|`showGrid`|`0` or `1`. If `1`, a `gridCols` x `gridRows` grid is drawn behind the markers and gaze targets. The size of each grid cell is 1 cm if `mode` is cm, or 1 degree if `mode` is `deg`.|
|`gridCols`|Number of grid columns to draw if `showGrid` is `1`.|
|`gridRows`|Number of grid rows to draw if `showGrid` is `1`.|
|`showAnnotations`|`0` or `1`. If `1`, text annotations informing about the size of grid cells () and markers is printed on the poster below the marker arrangement.|

### Steps for making your own poster.
1. Edit the [configuration](/src/glassesValidator/config/validationSetup.txt), [`markerPositions.csv`](/src/glassesValidator/config/markerPositions.csv) and [`targetPositions.csv`](/src/glassesValidator/config/targetPositions.csv) files in the [config folder](/src/glassesValidator/config) to design the layout and look of the poster that you want.
2. Run the [getMarkerImages.py Python script](/markerBoard/getMarkerImages.py) to generate the used ArUco markers.
3. Compile the [LaTeX file](/src/glassesValidator/config/markerBoard/board.tex) with pdfTex, such as provided in the TeX Live distribution.
4. Done, you should now have a pdf file with the poster as you defined.

